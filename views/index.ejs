<!DOCTYPE html>
<html>
    <%- include('partials/head.ejs') %>
    <body>
        <h1><%= title %></h1>
        <% if(authenticated) { %>
            <p>Welcome <%= username %>!</p>
            <a href="/auth/logout">Log Out</a>
        <% } else { %>
            <a href="/login">Log In</a>
            <a href="/register">Register</a>
        <% } %>
        <div class='board'>
            <div class='board-header'>
                <div class='header-info'>
                    <% if(count === 1) { %>
                        <%= count %> message
                    <% } else { %>
                        <%= count %> messages
                    <% } %>
                    <span>
                        Last message: <%= latest.toLocaleString([], {year: 'numeric', month: 'numeric', day: 'numeric'}) %>
                    </span>
                </div>
            </div>
            <ul class='messages'>
                <% messages.forEach(function(message) { %>
                    <li class='message'>
                        <div class='message-user'><%= message.user %></div>
                        <div class='message-date'><%= message.createdAt.toLocaleString([], {year: 'numeric', month: 'numeric', day: 'numeric', hour: '2-digit', minute:'2-digit'}) %></div>
                        <div class='message-text'><%= message.text %></div>
                    </li>
                <% }); %>
            </ul>
            <div class='board-footer'>
                <form method="POST" action="/new">
                    <div class='input-group'>
                        <input type="text" name="user" placeholder="Author" maxlength="15" required />
                        <input type="text" name="text" placeholder="Message" maxlength="250" required />
                    </div>
                    <button type="submit"><i class="fa-solid fa-paper-plane fa-2xl"></i></button>
                </form>
            </div>
        </div>
        <script src="https://kit.fontawesome.com/a0cabf7a73.js" crossorigin="anonymous"></script>
    </body>
</html>